<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2017.2 (Released Jan 23, 2017) -->
<HTML>
<HEAD>
<TITLE>The Liouville Operator Formalism to Generating MD Integration Schemes</TITLE>
<META NAME="description" CONTENT="The Liouville Operator Formalism to Generating MD Integration Schemes">
<META NAME="keywords" CONTENT="msim2">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2017.2">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="msim2.css">

<LINK REL="previous" HREF="node36.html">
<LINK REL="up" HREF="node35.html">
<LINK REL="next" HREF="node38.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A NAME="tex2html554"
  HREF="node38.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html552"
  HREF="node35.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html548"
  HREF="node36.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A>   
<BR>
<B> Next:</B> <A NAME="tex2html555"
  HREF="node38.html">Case Study 1: An</A>
<B> Up:</B> <A NAME="tex2html553"
  HREF="node35.html">MD: Theoretical Background</A>
<B> Previous:</B> <A NAME="tex2html549"
  HREF="node36.html">Newtonian Mechanics and Numerical</A>
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H3><A NAME="SECTION00041200000000000000"></A>
<A NAME="sec:liouville"></A>
<BR>
The Liouville Operator Formalism to Generating MD 
Integration Schemes
</H3>

<P>
In this section, we present an elegant formalism for deriving MD
integrators, as discussed by Tuckerman&nbsp;<EM>et
al.</EM>&nbsp;[<A
 HREF="node82.html#Tuckerman1992">6</A>].  What we present here is essentially the
first two parts of the second section of
Reference&nbsp;[<A
 HREF="node82.html#Tuckerman1992">6</A>], including some of my own elaboration
and some of that presented in section 4.3 of F&amp;S.

<P>
Imagine a quantity <SPAN CLASS="MATH"><IMG
 WIDTH="13" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img339.png"
 ALT="$ f$"></SPAN> which is a function of particle positions <SPAN CLASS="MATH"><IMG
 WIDTH="23" HEIGHT="17" ALIGN="BOTTOM" BORDER="0"
 SRC="img286.png"
 ALT="$ {\bf r}^N$"></SPAN>
and momenta <SPAN CLASS="MATH"><IMG
 WIDTH="26" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img412.png"
 ALT="$ {\bf p}^N$"></SPAN>.  Its time derivative is given by
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="eq:liouville_1"></A><!-- MATH
 \begin{equation}
\dot{f} = \dot{\bf r}\frac{\partial f}{\partial{\bf r}} + \dot{\bf p}\frac{\partial f}{\partial {\bf p}}
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="118" HEIGHT="51" ALIGN="MIDDLE" BORDER="0"
 SRC="img413.png"
 ALT="$\displaystyle \dot{f} = \dot{\bf r}\frac{\partial f}{\partial{\bf r}} + \dot{\bf p}\frac{\partial f}{\partial {\bf p}}$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">128</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
We can write down a <EM>formal</EM> solution to this equation.  First,
define the Liouville operator as
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
iL = \dot{\bf r}\frac{\partial}{\partial{\bf r}} + \dot{\bf p}\frac{\partial}{\partial {\bf p}}
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="122" HEIGHT="51" ALIGN="MIDDLE" BORDER="0"
 SRC="img414.png"
 ALT="$\displaystyle iL = \dot{\bf r}\frac{\partial}{\partial{\bf r}} + \dot{\bf p}\frac{\partial}{\partial {\bf p}}$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">129</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
As Tuckerman points out,
the <SPAN CLASS="MATH"><IMG
 WIDTH="9" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img22.png"
 ALT="$ i$"></SPAN> is there by convention and ensures that the operator is <EM>Hermitian</EM>.  We can re-express Eq.&nbsp;<A HREF="#eq:liouville_1">128</A> as
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\dot{f} = iLf
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="60" HEIGHT="38" ALIGN="MIDDLE" BORDER="0"
 SRC="img415.png"
 ALT="$\displaystyle \dot{f} = iLf$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">130</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
which we solve directly to yield
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
f\left(t\right) = \exp\left(iLt\right)f\left(0\right).
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="159" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img416.png"
 ALT="$\displaystyle f\left(t\right) = \exp\left(iLt\right)f\left(0\right).$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">131</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
If <SPAN CLASS="MATH"><IMG
 WIDTH="13" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img339.png"
 ALT="$ f$"></SPAN> is itself a vector quantity identical to the set of positions
and momenta, <SPAN CLASS="MATH"><IMG
 WIDTH="14" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img24.png"
 ALT="$ \Gamma$"></SPAN>, we have a way to express, formally, the
evolution of the system:
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A NAME="eq:propagator"></A><!-- MATH
 \begin{equation}
\Gamma\left(t\right) = U\left(t\right)\Gamma\left(0\right)
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="125" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img417.png"
 ALT="$\displaystyle \Gamma\left(t\right) = U\left(t\right)\Gamma\left(0\right)$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">132</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
where <!-- MATH
 $U(t) = \exp\left(iLt\right)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="117" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img418.png"
 ALT="$ U(t) = \exp\left(iLt\right)$"></SPAN> is the <EM>classical propagator</EM>.
The idea with numerical integration is that we find a way to represent
the propagator as a <EM>discrete algorithm</EM> for constructing the
system at some time <!-- MATH
 $t+ \Delta t$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="48" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img396.png"
 ALT="$ t + \Delta t$"></SPAN> given the system at time <SPAN CLASS="MATH"><IMG
 WIDTH="9" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img26.png"
 ALT="$ t$"></SPAN>.

<P>
Let's build our discrete integrator by decomposing the operator:
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
iL = iL_1 + iL_2
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="108" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img419.png"
 ALT="$\displaystyle iL = iL_1 + iL_2$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">133</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
This does not necessarily lead to two independent propagators, because 
the two components do not commute; that is:
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\exp\left[\left( iL_1 + iL_2\right)t\right] \ne \exp\left(iL_1t\right)\exp\left(iL_2t\right)
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="288" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img420.png"
 ALT="$\displaystyle \exp\left[\left( iL_1 + iL_2\right)t\right] \ne \exp\left(iL_1t\right)\exp\left(iL_2t\right)$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">134</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>

<P>
Consider the action of the partial Liouville operator
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
iL_1 \equiv \dot{\bf r}\left(0\right)\frac{\partial}{\partial{\bf r}},
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="107" HEIGHT="51" ALIGN="MIDDLE" BORDER="0"
 SRC="img421.png"
 ALT="$\displaystyle iL_1 \equiv \dot{\bf r}\left(0\right)\frac{\partial}{\partial{\bf r}},$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">135</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
which gives
<BR>
<DIV ALIGN="CENTER" CLASS="mathdisplay">
<!-- MATH
 \begin{eqnarray}
f\left[{\bf p}^N\left(t\right),{\bf r}^N\left(t\right)\right] & = &
\exp\left[t\dot{\bf r}\left(0\right)\frac{\partial}{\partial{\bf r}}\right]
f\left[{\bf p}^N\left(0\right),{\bf r}^N\left(0\right)\right]\\
& = & \sum_{n=0}^{\infty} \frac{\left(\dot{\bf r}\left(0\right)t\right)^n}{n!}\frac{\partial^n}{\partial{\bf r}^n}f\left[{\bf p}^N\left(0\right),{\bf r}^N\left(0\right)\right]\\
 & = & f\left[{\bf p}^N\left(0\right),{\bf r}^N\left(0\right)+\dot{\bf r}\left(0\right)\right]
\end{eqnarray}
 -->
<TABLE CELLPADDING="0" ALIGN="CENTER" WIDTH="100%">
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG
 WIDTH="122" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img422.png"
 ALT="$\displaystyle f\left[{\bf p}^N\left(t\right),{\bf r}^N\left(t\right)\right]$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img135.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP WIDTH="50%"><IMG
 WIDTH="233" HEIGHT="54" ALIGN="MIDDLE" BORDER="0"
 SRC="img423.png"
 ALT="$\displaystyle \exp\left[t\dot{\bf r}\left(0\right)\frac{\partial}{\partial{\bf r}}\right]
f\left[{\bf p}^N\left(0\right),{\bf r}^N\left(0\right)\right]$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(<SPAN CLASS="arabic">136</SPAN>)</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT">&nbsp;</TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img135.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP WIDTH="50%"><IMG
 WIDTH="246" HEIGHT="61" ALIGN="MIDDLE" BORDER="0"
 SRC="img424.png"
 ALT="$\displaystyle \sum_{n=0}^{\infty} \frac{\left(\dot{\bf r}\left(0\right)t\right)...
...\partial{\bf r}^n}f\left[{\bf p}^N\left(0\right),{\bf r}^N\left(0\right)\right]$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(<SPAN CLASS="arabic">137</SPAN>)</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT">&nbsp;</TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img135.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP WIDTH="50%"><IMG
 WIDTH="177" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img425.png"
 ALT="$\displaystyle f\left[{\bf p}^N\left(0\right),{\bf r}^N\left(0\right)+\dot{\bf r}\left(0\right)\right]$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(<SPAN CLASS="arabic">138</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL">

The last line is the collapse of the Taylor expansion of the line
immediately above it.  So, the effect of this operator fragment is a
simple shift of coordinates given some initial velocities.  This is an
interesting fact: we can consider first-order integration as a Taylor
expansion.

<P>
The next step of Tuckerman was to apply the Trotter identity:
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\exp\left[\left( iL_1 + iL_2\right)t\right] = \lim_{P\rightarrow\infty}
\left[\exp\left(iL_1t/2P\right)\exp\left(iL_t2/P\right)\exp\left(iL_1t/2P\right)\right]^P
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="494" HEIGHT="39" ALIGN="MIDDLE" BORDER="0"
 SRC="img426.png"
 ALT="$\displaystyle \exp\left[\left( iL_1 + iL_2\right)t\right] = \lim_{P\rightarrow\...
...\left(iL_1t/2P\right)\exp\left(iL_t2/P\right)\exp\left(iL_1t/2P\right)\right]^P$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">139</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
When <SPAN CLASS="MATH"><IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img10.png"
 ALT="$ P$"></SPAN> is large but finite:
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\exp\left[\left(iL_1 + iL_2\right)t\right] =
\left[\exp\left(iL_1t/2P\right)\exp\left(iL_2t/P\right)\exp\left(iL_1t/2P\right)\right]^P\exp\left[\mathscr{O}\left(1/P^2\right)\right]
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="560" HEIGHT="40" ALIGN="MIDDLE" BORDER="0"
 SRC="img427.png"
 ALT="$\displaystyle \exp\left[\left(iL_1 + iL_2\right)t\right] = \left[\exp\left(iL_1...
...exp\left(iL_1t/2P\right)\right]^P\exp\left[\mathscr{O}\left(1/P^2\right)\right]$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">140</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
Now, we define a finite timestep as <!-- MATH
 $\Delta t = t/P$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="70" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img428.png"
 ALT="$ \Delta t = t/P$"></SPAN> and we have then
a discrete operator that, when applied to a configuration at time <SPAN CLASS="MATH"><IMG
 WIDTH="9" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img26.png"
 ALT="$ t$"></SPAN>, will
produce the configuration at time <!-- MATH
 $t + \Delta t$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="48" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img396.png"
 ALT="$ t + \Delta t$"></SPAN>:
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\exp\left(iL_1\Delta t/2\right)\exp\left(iL_2\Delta t\right)\exp\left(iL_1\Delta t/2\right)\Gamma\left(t\right) = \Gamma\left(t+\Delta t\right)
\end{equation}
 -->
<TABLE CLASS="equation" CELLPADDING="0" WIDTH="100%" ALIGN="CENTER">
<TR VALIGN="MIDDLE">
<TD NOWRAP ALIGN="CENTER"><SPAN CLASS="MATH"><IMG
 WIDTH="410" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img429.png"
 ALT="$\displaystyle \exp\left(iL_1\Delta t/2\right)\exp\left(iL_2\Delta t\right)\exp\left(iL_1\Delta t/2\right)\Gamma\left(t\right) = \Gamma\left(t+\Delta t\right)$"></SPAN></TD>
<TD NOWRAP CLASS="eqno" WIDTH="10" ALIGN="RIGHT">
(<SPAN CLASS="arabic">141</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
By performing this operation sequentially <SPAN CLASS="MATH"><IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img10.png"
 ALT="$ P$"></SPAN> times, we recover a
discretized version of the formal solution to generate
<!-- MATH
 $\Gamma\left(t\right)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="34" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img430.png"
 ALT="$ \Gamma\left(t\right)$"></SPAN> given <!-- MATH
 $\Gamma\left(0\right)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="37" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img431.png"
 ALT="$ \Gamma\left(0\right)$"></SPAN>.

<P>
Now we explicitly consider the decomposition:
<BR>
<DIV ALIGN="CENTER" CLASS="mathdisplay">
<!-- MATH
 \begin{eqnarray}
iL_1 & = & \dot{\bf p}\left(0\right)\frac{\partial}{\partial{\bf p}}\\
iL_2 & = & \dot{\bf r}\left(0\right)\frac{\partial}{\partial{\bf r}}
\end{eqnarray}
 -->
<TABLE CELLPADDING="0" ALIGN="CENTER" WIDTH="100%">
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG
 WIDTH="27" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img432.png"
 ALT="$\displaystyle iL_1$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img135.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP WIDTH="50%"><IMG
 WIDTH="63" HEIGHT="51" ALIGN="MIDDLE" BORDER="0"
 SRC="img433.png"
 ALT="$\displaystyle \dot{\bf p}\left(0\right)\frac{\partial}{\partial{\bf p}}$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(<SPAN CLASS="arabic">142</SPAN>)</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG
 WIDTH="27" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img434.png"
 ALT="$\displaystyle iL_2$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img135.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP WIDTH="50%"><IMG
 WIDTH="58" HEIGHT="51" ALIGN="MIDDLE" BORDER="0"
 SRC="img435.png"
 ALT="$\displaystyle \dot{\bf r}\left(0\right)\frac{\partial}{\partial{\bf r}}$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(<SPAN CLASS="arabic">143</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL">

<P>
We can perform one <SPAN CLASS="MATH"><IMG
 WIDTH="23" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img25.png"
 ALT="$ \Delta t$"></SPAN>'s worth of update using the following operation
on <SPAN CLASS="MATH"><IMG
 WIDTH="13" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img339.png"
 ALT="$ f$"></SPAN>:
<P><!-- MATH
 \begin{displaymath}
\exp\left(\dot{\bf p}\left(0\right)\left(\frac{\partial}{\partial{\bf p}}\right)\frac{\Delta t}{2}\right)
\exp\left(\dot{\bf r}\left(0\right)\left(\frac{\partial}{\partial{\bf r}}\right)\Delta t\right)
\exp\left(\dot{\bf p}\left(0\right)\left(\frac{\partial}{\partial{\bf p}}\right)\frac{\Delta t}{2}\right)
f\left[{\bf p}^N\left(t\right),{\bf r}^N\left(t\right)\right]
\end{displaymath}
 -->
</P>
<DIV ALIGN="CENTER" CLASS="mathdisplay">
<IMG
 WIDTH="592" HEIGHT="54" ALIGN="MIDDLE" BORDER="0"
 SRC="img436.png"
 ALT="$\displaystyle \exp\left(\dot{\bf p}\left(0\right)\left(\frac{\partial}{\partial...
...ta t}{2}\right)
f\left[{\bf p}^N\left(t\right),{\bf r}^N\left(t\right)\right]
$">
</DIV><P></P>
The action of the rightmost operator, <!-- MATH
 $\exp\left(\dot{\bf p}\left(0\right)\left(\frac{\partial}{\partial{\bf p}}\right)\frac{\Delta t}{2}\right)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="146" HEIGHT="45" ALIGN="MIDDLE" BORDER="0"
 SRC="img437.png"
 ALT="$ \exp\left(\dot{\bf p}\left(0\right)\left(\frac{\partial}{\partial{\bf p}}\right)\frac{\Delta t}{2}\right)$"></SPAN>:
<P><!-- MATH
 \begin{displaymath}
f\left[{\bf p}^N\left(t\right),{\bf r}^N\left(t\right)\right] \rightarrow
f\left\{\left[{\bf p}\left(t\right)+\frac{\Delta t}{2}\dot{\bf p}\left(\Delta t\right)\right]^N,\left[{\bf r}\left(t\right)\right]^N\right\}
\end{displaymath}
 -->
</P>
<DIV ALIGN="CENTER" CLASS="mathdisplay">
<IMG
 WIDTH="390" HEIGHT="63" ALIGN="MIDDLE" BORDER="0"
 SRC="img438.png"
 ALT="$\displaystyle f\left[{\bf p}^N\left(t\right),{\bf r}^N\left(t\right)\right] \ri...
... p}\left(\Delta t\right)\right]^N,\left[{\bf r}\left(t\right)\right]^N\right\}
$">
</DIV><P></P>
The action of the next rightmost, <!-- MATH
 $\exp\left(\dot{\bf r}\left(0\right)\left(\frac{\partial}{\partial{\bf r}}\right)\Delta t\right)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="132" HEIGHT="39" ALIGN="MIDDLE" BORDER="0"
 SRC="img439.png"
 ALT="$ \exp\left(\dot{\bf r}\left(0\right)\left(\frac{\partial}{\partial{\bf r}}\right)\Delta t\right)$"></SPAN>:
<P><!-- MATH
 \begin{displaymath}
f\left\{\left[{\bf p}\left(t\right)+\frac{\Delta t}{2}\dot{\bf p}\left(\Delta t\right)\right]^N,\left[{\bf r}\left(t\right)\right]^N\right\} \rightarrow
   f\left\{\left[{\bf p}\left(t\right)+\frac{\Delta t}{2}\dot{\bf p}\left(0\right)\right]^N,
           \left[{\bf r}\left(t\right)+ \Delta t \dot{\bf r}\left(\frac{\Delta t}{2}\right)\right]^N\right\}
\end{displaymath}
 -->
</P>
<DIV ALIGN="CENTER" CLASS="mathdisplay">
<IMG
 WIDTH="603" HEIGHT="64" ALIGN="MIDDLE" BORDER="0"
 SRC="img440.png"
 ALT="$\displaystyle f\left\{\left[{\bf p}\left(t\right)+\frac{\Delta t}{2}\dot{\bf p}...
...t\right)+ \Delta t \dot{\bf r}\left(\frac{\Delta t}{2}\right)\right]^N\right\}
$">
</DIV><P></P>
Then, the action of the final operator:
<P><!-- MATH
 \begin{displaymath}
f\left\{\left[{\bf p}\left(t\right)+\frac{\Delta t}{2}\dot{\bf p}\left(0\right)\right]^N,
           \left[{\bf r}\left(t\right)+ \Delta t \dot{\bf r}\left(\frac{\Delta t}{2}\right)\right]^N\right\}
\rightarrow f\left\{\left[{\bf p}\left(t\right)+\frac{\Delta t}{2}\dot{\bf p}\left(0\right)+
	\frac{\Delta t}{2}\dot{\bf p}\left(\Delta t\right)\right]^N,
           \left[{\bf r}\left(t\right)+ \Delta t \dot{\bf r}\left(\frac{\Delta t}{2}\right)\right]^N\right\}\\
\end{displaymath}
 -->
</P>
<DIV ALIGN="CENTER" CLASS="mathdisplay">
<IMG
 WIDTH="781" HEIGHT="64" ALIGN="MIDDLE" BORDER="0"
 SRC="img441.png"
 ALT="$\displaystyle f\left\{\left[{\bf p}\left(t\right)+\frac{\Delta t}{2}\dot{\bf p}...
...ight)+ \Delta t \dot{\bf r}\left(\frac{\Delta t}{2}\right)\right]^N\right\}\\
$">
</DIV><P></P>

<P>
Noting that <!-- MATH
 ${\bf p} = m\dot{\bf r}$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="57" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img442.png"
 ALT="$ {\bf p} = m\dot{\bf r}$"></SPAN> and <!-- MATH
 ${\bf F} = m{\bf a} = \dot{\bf p}$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="91" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img443.png"
 ALT="$ {\bf F} = m{\bf a} = \dot{\bf p}$"></SPAN>, we can summarize the 
effect of this three-step update of the positions and velocities as
<BR>
<DIV ALIGN="CENTER" CLASS="mathdisplay">
<!-- MATH
 \begin{eqnarray}
{\bf r}\left(\Delta t\right) & = & {\bf r}\left(0\right) +
                                   \Delta t \dot{\bf r}\left(0\right) + 
                                   \frac{\left(\Delta t\right)^2}{2}
\frac{{\bf F}\left[{\bf r}\left(0\right)\right]}{m},\\
\dot{\bf r}\left(\Delta t\right) & = & \dot{\bf r}\left(0\right) + \frac{\Delta t}{2m}
\left\{{\bf F}\left[{\bf r}\left(0\right)\right] + {\bf F}\left[{\bf r}\left(\Delta t\right)\right]\right\}
\end{eqnarray}
 -->
<TABLE CELLPADDING="0" ALIGN="CENTER" WIDTH="100%">
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG
 WIDTH="45" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img444.png"
 ALT="$\displaystyle {\bf r}\left(\Delta t\right)$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img135.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP WIDTH="50%"><IMG
 WIDTH="227" HEIGHT="59" ALIGN="MIDDLE" BORDER="0"
 SRC="img445.png"
 ALT="$\displaystyle {\bf r}\left(0\right) +
\Delta t \dot{\bf r}\left(0\right) +
\frac{\left(\Delta t\right)^2}{2}
\frac{{\bf F}\left[{\bf r}\left(0\right)\right]}{m},$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(<SPAN CLASS="arabic">144</SPAN>)</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG
 WIDTH="45" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img446.png"
 ALT="$\displaystyle \dot{\bf r}\left(\Delta t\right)$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img135.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP WIDTH="50%"><IMG
 WIDTH="236" HEIGHT="51" ALIGN="MIDDLE" BORDER="0"
 SRC="img447.png"
 ALT="$\displaystyle \dot{\bf r}\left(0\right) + \frac{\Delta t}{2m}
\left\{{\bf F}\le...
...left(0\right)\right] + {\bf F}\left[{\bf r}\left(\Delta t\right)\right]\right\}$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(<SPAN CLASS="arabic">145</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL">

<P>
This is the velocity-Verlet algorithm, seen previously in Eqs&nbsp;<A HREF="node36.html#eq:vv:pos">125</A>-<A HREF="node36.html#eq:vv:second_half">127</A>.
Interestingly, we can also reverse the order of the decomposition; i.e.,
<BR>
<DIV ALIGN="CENTER" CLASS="mathdisplay">
<!-- MATH
 \begin{eqnarray}
iL_1 & = & \dot{\bf r}\left(0\right)\frac{\partial}{\partial{\bf r}}\\
iL_2 & = & \dot{\bf p}\left(0\right)\frac{\partial}{\partial{\bf p}}
\end{eqnarray}
 -->
<TABLE CELLPADDING="0" ALIGN="CENTER" WIDTH="100%">
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG
 WIDTH="27" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img432.png"
 ALT="$\displaystyle iL_1$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img135.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP WIDTH="50%"><IMG
 WIDTH="58" HEIGHT="51" ALIGN="MIDDLE" BORDER="0"
 SRC="img435.png"
 ALT="$\displaystyle \dot{\bf r}\left(0\right)\frac{\partial}{\partial{\bf r}}$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(<SPAN CLASS="arabic">146</SPAN>)</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG
 WIDTH="27" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img434.png"
 ALT="$\displaystyle iL_2$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img135.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP WIDTH="50%"><IMG
 WIDTH="63" HEIGHT="51" ALIGN="MIDDLE" BORDER="0"
 SRC="img433.png"
 ALT="$\displaystyle \dot{\bf p}\left(0\right)\frac{\partial}{\partial{\bf p}}$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(<SPAN CLASS="arabic">147</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL">

The update algorithm that arises is
<BR>
<DIV ALIGN="CENTER" CLASS="mathdisplay">
<!-- MATH
 \begin{eqnarray}
\dot{\bf r}\left(\Delta t\right) & = & \dot{\bf r}\left(0\right) +
	\Delta t {\bf F}\left[{\bf r}\left(0\right) +
	                      \frac{\Delta t}{2m}\dot{\bf r}\left(0\right)\right]\\
{\bf r}\left(\Delta t\right) & = & {\bf r}\left(0\right) + 
                                   \frac{\Delta t}{2}\left[\dot{\bf x}\left(0\right)
	 						  +\dot{\bf x}\left(\Delta t\right)\right].
\end{eqnarray}
 -->
<TABLE CELLPADDING="0" ALIGN="CENTER" WIDTH="100%">
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG
 WIDTH="45" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img446.png"
 ALT="$\displaystyle \dot{\bf r}\left(\Delta t\right)$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img135.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP WIDTH="50%"><IMG
 WIDTH="210" HEIGHT="54" ALIGN="MIDDLE" BORDER="0"
 SRC="img448.png"
 ALT="$\displaystyle \dot{\bf r}\left(0\right) +
\Delta t {\bf F}\left[{\bf r}\left(0\right) +
\frac{\Delta t}{2m}\dot{\bf r}\left(0\right)\right]$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(<SPAN CLASS="arabic">148</SPAN>)</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG
 WIDTH="45" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="img444.png"
 ALT="$\displaystyle {\bf r}\left(\Delta t\right)$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img135.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP WIDTH="50%"><IMG
 WIDTH="191" HEIGHT="51" ALIGN="MIDDLE" BORDER="0"
 SRC="img449.png"
 ALT="$\displaystyle {\bf r}\left(0\right) +
\frac{\Delta t}{2}\left[\dot{\bf x}\left(0\right)
+\dot{\bf x}\left(\Delta t\right)\right].$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(<SPAN CLASS="arabic">149</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL">

This is termed the <EM>position Verlet</EM>
algorithm&nbsp;[<A
 HREF="node82.html#Tuckerman1992">6</A>].  Tuckerman <EM>et al.</EM> showed that
this new algorithm results in a slightly lower drift in total energy
in MD simulation of a simple Lennard-Jones fluid, when the time-step
is greater than about 0.004.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html554"
  HREF="node38.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html552"
  HREF="node35.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html548"
  HREF="node36.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A>   
<BR>
<B> Next:</B> <A NAME="tex2html555"
  HREF="node38.html">Case Study 1: An</A>
<B> Up:</B> <A NAME="tex2html553"
  HREF="node35.html">MD: Theoretical Background</A>
<B> Previous:</B> <A NAME="tex2html549"
  HREF="node36.html">Newtonian Mechanics and Numerical</A></DIV>
<!--End of Navigation Panel-->
<ADDRESS>
cfa22@drexel.edu
</ADDRESS>
</BODY>
</HTML>
